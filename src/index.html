<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boa Vida Fish Finder - Bazaruto Fishing Guide</title>
    <meta name="description" content="Data-driven fishing guide for Bazaruto waters based on historical catch data">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/assets/images/fav.png">
    <link rel="apple-touch-icon" href="/assets/images/fav.png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Papa Parse for CSV parsing -->
    <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
    
    <!-- Lodash for data manipulation -->
    <script src="https://unpkg.com/lodash@4.17.21/lodash.min.js"></script>
    
    <!-- Lucide React Icons -->
    <script src="https://unpkg.com/lucide-react@0.263.1/dist/umd/lucide-react.js"></script>
    
    <!-- Configuration -->
    <script src="config.js"></script>
    
    <style>
        /* Additional mobile optimizations */
        body {
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Ensure good contrast in bright sunlight */
        .sunlight-optimized {
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }
        
        /* Loading animation */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        
        /* Smooth transitions */
        .transition-all {
            transition: all 0.3s ease;
        }
        
        /* Modal overlay */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        /* Form animation */
        @keyframes slideIn {
            from {
                transform: translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        /* Floating action button */
        .fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 900;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
            min-width: 120px;
            border: 3px solid white;
        }
        
        /* Status badge pulse */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .pulse {
            animation: pulse 2s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <!-- Debug Element - Always Visible -->
    <div id="debug-element" style="position: fixed; top: 10px; right: 10px; background-color: red; color: white; padding: 10px; z-index: 9999; font-weight: bold;">
        DEBUG: Buttons should be visible
    </div>
    
    <!-- Fallback Button (Pure HTML) -->
    <div style="position: fixed; bottom: 80px; right: 20px; z-index: 10000;">
        <a href="https://docs.google.com/forms/d/e/1FAIpQLSdvpVR2RHX20eDRkGjjlfyyZyBwaViGhszCn7sh0DVyfhim6g/viewform?usp=header" 
           target="_blank"
           rel="noopener noreferrer"
           style="display: inline-block; background-color: blue; color: white; padding: 15px 30px; border-radius: 8px; font-weight: bold; text-decoration: none; box-shadow: 0 4px 8px rgba(0,0,0,0.3);">
            FALLBACK BUTTON - LOG A CATCH
        </a>
    </div>

    <script>
        const { useState, useEffect, useRef } = React;
        const { Fish, MapPin, Sun, Moon, Droplets, Clock, TrendingUp, AlertCircle, Plus, RefreshCw, Wifi, WifiOff, X, Save, CheckCircle } = lucideReact;
        
        // ============================================
        // IndexedDB Manager for Offline Storage
        // ============================================
        const DB_NAME = 'BoaVidaFishDB';
        const DB_VERSION = 1;
        const STORE_NAME = 'pendingCatches';
        
        const initDB = () => {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(DB_NAME, DB_VERSION);
                
                request.onerror = () => reject(request.error);
                request.onsuccess = () => resolve(request.result);
                
                request.onupgradeneeded = (event) => {
                    const db = event.target.result;
                    if (!db.objectStoreNames.contains(STORE_NAME)) {
                        const objectStore = db.createObjectStore(STORE_NAME, { keyPath: 'id', autoIncrement: true });
                        objectStore.createIndex('timestamp', 'timestamp', { unique: false });
                    }
                };
            });
        };
        
        const saveCatchToDB = async (catchData) => {
            const db = await initDB();
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([STORE_NAME], 'readwrite');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.add({
                    ...catchData,
                    timestamp: new Date().toISOString()
                });
                
                request.onsuccess = () => resolve(request.result);
                request.onerror = () => reject(request.error);
            });
        };
        
        const getPendingCatches = async () => {
            const db = await initDB();
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([STORE_NAME], 'readonly');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.getAll();
                
                request.onsuccess = () => resolve(request.result);
                request.onerror = () => reject(request.error);
            });
        };
        
        const deleteCatchFromDB = async (id) => {
            const db = await initDB();
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([STORE_NAME], 'readwrite');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.delete(id);
                
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        };
        
        // ============================================
        // Google Sheets API Functions
        // ============================================
        const loadFromGoogleSheets = async () => {
            const config = window.GOOGLE_SHEETS_CONFIG;
            if (!config || !config.ENABLED || !config.SHEET_ID || !config.READ_API_KEY) {
                console.log('Google Sheets not configured');
                return null;
            }
            
            try {
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${config.SHEET_ID}/values/${config.READ_RANGE}?key=${config.READ_API_KEY}`;
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`Google Sheets API error: ${response.status}`);
                }
                
                const data = await response.json();
                const rows = data.values;
                
                if (!rows || rows.length === 0) {
                    throw new Error('No data found in Google Sheet');
                }
                
                // Convert to CSV format for Papa Parse
                const csv = rows.map(row => row.join(',')).join('\n');
                return csv;
            } catch (error) {
                console.error('Error loading from Google Sheets:', error);
                return null;
            }
        };
        
        const syncCatchToGoogleSheets = async (catchData) => {
            const config = window.GOOGLE_SHEETS_CONFIG;
            if (!config || !config.ENABLED || !config.SHEET_ID || !config.WRITE_API_KEY) {
                throw new Error('Google Sheets not configured for writing');
            }
            
            // Convert catchData to row format matching CSV columns (18 columns: A-R)
            const row = [
                catchData.date,                                    // 1. Date
                catchData.species,                                 // 2. Species
                catchData.weightLbs,                               // 3. Weight (lbs)
                catchData.length || '',                            // 4. Length (m)
                catchData.place,                                   // 5. Place
                catchData.primaryBait,                             // 6. Primary_Bait
                catchData.enhancement || '',                       // 7. Enhancement
                catchData.lineLbs || '',                           // 8. Line (lbs)
                catchData.timeOfStrike,                            // 9. Time of Strike
                catchData.waterTemp || '',                         // 10. Water Temperature (Â°C)
                catchData.weather || '',                           // 11. Weather
                catchData.tideState || '',                         // 12. Tide State
                '',                                                // 13. Tide Height (m) - empty for now
                '',                                                // 14. Tidal Coefficient - empty for now
                catchData.weather === 'Clear' ? '10' : 
                    catchData.weather === 'Partly Cloudy' ? '40' : '80', // 15. Cloud Cover (%)
                `Catch logged via app on ${new Date().toLocaleDateString()}`, // 16. Description
                catchData.airTemp || '',                           // 17. Air Temp (Â°C)
                catchData.moon || ''                               // 18. Moon
            ];
            
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${config.SHEET_ID}/values/${config.WRITE_RANGE}:append?valueInputOption=USER_ENTERED&key=${config.WRITE_API_KEY}`;
            
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    values: [row]
                })
            });
            
            if (!response.ok) {
                const error = await response.json();
                throw new Error(`Failed to sync to Google Sheets: ${error.error?.message || response.status}`);
            }
            
            return await response.json();
        };
        
        // ============================================
        // Cache Management
        // ============================================
        const CACHE_KEY = 'fishingDataCache';
        const CACHE_TIMESTAMP_KEY = 'fishingDataCacheTimestamp';
        
        const getCachedData = () => {
            const cached = localStorage.getItem(CACHE_KEY);
            const timestamp = localStorage.getItem(CACHE_TIMESTAMP_KEY);
            
            if (!cached || !timestamp) return null;
            
            const config = window.GOOGLE_SHEETS_CONFIG || { CACHE_DURATION: 5 * 60 * 1000 };
            const age = Date.now() - parseInt(timestamp);
            
            if (age > config.CACHE_DURATION) {
                return null; // Cache expired
            }
            
            return cached;
        };
        
        const setCachedData = (data) => {
            localStorage.setItem(CACHE_KEY, data);
            localStorage.setItem(CACHE_TIMESTAMP_KEY, Date.now().toString());
        };
        
        const getLastSyncTime = () => {
            const timestamp = localStorage.getItem(CACHE_TIMESTAMP_KEY);
            if (!timestamp) return null;
            return new Date(parseInt(timestamp));
        };

        const SimpleFishingGuide = () => {
            const [data, setData] = useState([]);
            const [loading, setLoading] = useState(false);
            const [selectedFish, setSelectedFish] = useState('');
            const [recommendations, setRecommendations] = useState(null);
            const [species, setSpecies] = useState([]);
            const [error, setError] = useState(null);
            const [showForm, setShowForm] = useState(false);
            const [pendingCount, setPendingCount] = useState(0);
            const [isOnline, setIsOnline] = useState(navigator.onLine);
            const [syncing, setSyncing] = useState(false);
            const [lastSync, setLastSync] = useState(null);
            const [notification, setNotification] = useState(null);
            const [locations, setLocations] = useState([]);
            const [baits, setBaits] = useState([]);
            const [enhancements, setEnhancements] = useState([]);

            useEffect(() => {
                loadData();
                updatePendingCount();
                setLastSync(getLastSyncTime());
                
                // Online/offline detection
                const handleOnline = () => {
                    setIsOnline(true);
                    autoSync();
                };
                const handleOffline = () => setIsOnline(false);
                
                window.addEventListener('online', handleOnline);
                window.addEventListener('offline', handleOffline);
                
                // Auto-sync on mount if online
                if (navigator.onLine) {
                    autoSync();
                }
                
                return () => {
                    window.removeEventListener('online', handleOnline);
                    window.removeEventListener('offline', handleOffline);
                };
            }, []);
            
            const updatePendingCount = async () => {
                try {
                    const pending = await getPendingCatches();
                    setPendingCount(pending.length);
                } catch (error) {
                    console.error('Error getting pending catches:', error);
                }
            };
            
            const showNotification = (message, type = 'success') => {
                setNotification({ message, type });
                setTimeout(() => setNotification(null), 5000);
            };
            
            const autoSync = async () => {
                if (!isOnline) return;
                
                try {
                    const pending = await getPendingCatches();
                    if (pending.length > 0) {
                        await syncPendingCatches();
                    }
                } catch (error) {
                    console.error('Auto-sync failed:', error);
                }
            };
            
            const syncPendingCatches = async () => {
                try {
                    setSyncing(true);
                    const pending = await getPendingCatches();
                    
                    if (pending.length === 0) {
                        showNotification('No pending catches to sync', 'info');
                        return;
                    }
                    
                    let successCount = 0;
                    let failCount = 0;
                    
                    for (const catch_ of pending) {
                        try {
                            await syncCatchToGoogleSheets(catch_);
                            await deleteCatchFromDB(catch_.id);
                            successCount++;
                        } catch (error) {
                            console.error('Failed to sync catch:', error);
                            failCount++;
                        }
                    }
                    
                    await updatePendingCount();
                    
                    if (successCount > 0) {
                        showNotification(`Synced ${successCount} catch${successCount > 1 ? 'es' : ''} to Google Sheets!`, 'success');
                        // Refresh data after sync
                        await loadData();
                    }
                    
                    if (failCount > 0) {
                        showNotification(`Failed to sync ${failCount} catch${failCount > 1 ? 'es' : ''}`, 'error');
                    }
                } catch (error) {
                    console.error('Sync error:', error);
                    showNotification('Sync failed: ' + error.message, 'error');
                } finally {
                    setSyncing(false);
                }
            };

            const loadData = async () => {
                try {
                    setLoading(true);
                    setError(null);
                    
                    let csvData = null;
                    let dataSource = 'unknown';
                    
                    // Try cache first
                    const cached = getCachedData();
                    if (cached) {
                        console.log('Using cached data');
                        csvData = cached;
                        dataSource = 'cache';
                    }
                    
                    // Try Google Sheets if online and not using cache
                    if (!csvData && isOnline) {
                        console.log('Attempting to load from Google Sheets...');
                        csvData = await loadFromGoogleSheets();
                        if (csvData) {
                            console.log('Loaded from Google Sheets');
                            setCachedData(csvData);
                            setLastSync(new Date());
                            dataSource = 'google-sheets';
                        }
                    }
                    
                    // Fallback to CSV files
                    if (!csvData) {
                        console.log('Falling back to CSV files...');
                        const possibleFilenames = [
                            '../Boa_Vida_Fish_Finder_data.csv',
                            'data/Boa_Vida_Fish_Finder_data.csv',
                            'Boa_Vida_Fish_Finder_data.csv',
                            'Baz  Stage 2 of Enriched Data 2.csv',
                            'Baz  Enriched Data.csv',
                            'Baz Data.csv'
                        ];
                        
                        for (const filename of possibleFilenames) {
                            try {
                                const response = await fetch(filename);
                                if (response.ok) {
                                    csvData = await response.text();
                                    console.log(`Successfully loaded: ${filename}`);
                                    dataSource = 'csv';
                                    break;
                                }
                            } catch (err) {
                                console.log(`Could not load: ${filename}`);
                            }
                        }
                    }
                    
                    if (!csvData) {
                        throw new Error('Could not load fishing data from any source. Please check your configuration.');
                    }
                    
                    console.log(`Data loaded from: ${dataSource}`);
                    
                    Papa.parse(csvData, {
                        header: true,
                        skipEmptyLines: true,
                        dynamicTyping: true,
                        complete: (results) => {
                            const cleanedData = results.data
                                .filter(row => row.Species && row.Species.trim() !== '')
                                .map(row => {
                                    // Handle column names with trailing spaces
                                    const place = row.Place || row['Place '] || row['Place  '];
                                    const primaryBait = row.Primary_Bait || row['Primary_Bait '] || row.Bait || row['Bait '];
                                    const timeOfStrike = row['Time of Strike'] || row['Time of Strike '] || row['Time of Strike  '];
                                    const weather = row.Weather || row['Weather '] || row['Weather  '];
                                    
                                    return {
                                        Species: row.Species?.trim(),
                                        Weight: parseFloat(row['Weight (lbs)']) * 0.453592 || 0,  // Convert lbs to kg for internal use
                                        WeightLbs: parseFloat(row['Weight (lbs)']) || 0,
                                        Length: parseFloat(row['Length (m)']) || 0,
                                        Place: place?.trim() || 'Unknown',
                                        PrimaryBait: primaryBait?.trim() || 'Unknown',
                                        Enhancement: row.Enhancement?.trim() || '',
                                        LineLbs: parseFloat(row['Line (lbs)']) || 0,
                                        WaterTemp: parseFloat(row['Water Temperature (Â°C)']) || parseFloat(row['Water Temperature (C)']) || 0,
                                        Moon: row.Moon?.trim() || 'Unknown',
                                        TideState: row['Tide State']?.trim() || 'Unknown',
                                        TimeOfStrike: timeOfStrike?.trim() || '',
                                        Weather: weather?.trim() || '',
                                        CloudCover: parseInt(row['Cloud Cover (%)']) || 0,
                                        TideHeight: parseFloat(row['Tide Height (m)']) || 0,
                                        TidalCoeff: parseInt(row['Tidal Coefficient']) || 0,
                                        AirTemp: parseFloat(row['Air Temp (Â°C)']) || 0
                                    };
                                });
                            
                            setData(cleanedData);
                            const uniqueSpecies = _.uniq(cleanedData.map(d => d.Species)).sort();
                            setSpecies(uniqueSpecies);
                            
                            // Extract unique values for form dropdowns
                            const uniqueLocations = _.uniq(cleanedData.map(d => d.Place).filter(p => p && p !== 'Unknown')).sort();
                            setLocations(uniqueLocations);
                            
                            const uniqueBaits = _.uniq(cleanedData.map(d => d.PrimaryBait).filter(b => b && b !== 'Unknown')).sort();
                            setBaits(uniqueBaits);
                            
                            const uniqueEnhancements = _.uniq(cleanedData.map(d => d.Enhancement).filter(e => e && e !== 'Unknown' && e !== '')).sort();
                            setEnhancements(uniqueEnhancements);
                            
                            if (uniqueSpecies.length > 0) {
                                setSelectedFish(uniqueSpecies[0]);
                                analyzeSpecies(uniqueSpecies[0], cleanedData);
                            }
                        },
                        error: (error) => {
                            throw new Error(`CSV parsing error: ${error.message}`);
                        }
                    });
                } catch (error) {
                    console.error('Error loading data:', error);
                    setError(error.message);
                } finally {
                    setLoading(false);
                }
            };

            const analyzeSpecies = (fishSpecies, fishingData) => {
                const speciesData = fishingData.filter(d => d.Species === fishSpecies);
                
                if (speciesData.length === 0) {
                    setRecommendations(null);
                    return;
                }

                // Best locations
                const locationCounts = _(speciesData)
                    .groupBy('Place')
                    .mapValues(records => ({
                        count: records.length,
                        avgWeight: _.meanBy(records, 'WeightLbs'),
                        percentage: (records.length / speciesData.length * 100)
                    }))
                    .entries()
                    .orderBy([1, 'count'], ['desc'])
                    .value();

                // Best baits (using Primary_Bait)
                const baitCounts = _(speciesData)
                    .groupBy('PrimaryBait')
                    .mapValues(records => ({
                        count: records.length,
                        avgWeight: _.meanBy(records, 'WeightLbs'),
                        percentage: (records.length / speciesData.length * 100)
                    }))
                    .entries()
                    .orderBy([1, 'count'], ['desc'])
                    .value();

                // Best enhancements (when used with primary bait)
                const enhancementCounts = _(speciesData)
                    .filter(record => record.Enhancement && record.Enhancement !== 'Unknown' && record.Enhancement !== '')
                    .groupBy('Enhancement')
                    .mapValues(records => ({
                        count: records.length,
                        avgWeight: _.meanBy(records, 'WeightLbs'),
                        percentage: (records.length / speciesData.filter(r => r.Enhancement && r.Enhancement !== '').length * 100),
                        usedWith: _.chain(records).groupBy('PrimaryBait').mapValues('length').entries().orderBy([1], ['desc']).value()[0]
                    }))
                    .entries()
                    .orderBy([1, 'count'], ['desc'])
                    .value();

                // Best moon phases
                const moonCounts = _(speciesData)
                    .groupBy('Moon')
                    .mapValues(records => ({
                        count: records.length,
                        percentage: (records.length / speciesData.length * 100)
                    }))
                    .entries()
                    .orderBy([1, 'count'], ['desc'])
                    .value();

                // Best tide states
                const tideCounts = _(speciesData)
                    .groupBy('TideState')
                    .mapValues(records => ({
                        count: records.length,
                        percentage: (records.length / speciesData.length * 100)
                    }))
                    .entries()
                    .orderBy([1, 'count'], ['desc'])
                    .value();

                // Best time of day
                const timeOfDay = _(speciesData)
                    .groupBy(row => {
                        const time = row.TimeOfStrike;
                        if (!time) return 'Unknown';
                        const hour = parseInt(time.split(':')[0]);
                        if (hour >= 5 && hour < 12) return 'Morning (5am-12pm)';
                        if (hour >= 12 && hour < 17) return 'Afternoon (12pm-5pm)';
                        if (hour >= 17 && hour < 20) return 'Evening (5pm-8pm)';
                        return 'Night (8pm-5am)';
                    })
                    .mapValues(records => ({
                        count: records.length,
                        percentage: (records.length / speciesData.length * 100)
                    }))
                    .entries()
                    .orderBy([1, 'count'], ['desc'])
                    .value();

                // Weather conditions - exclude zero/missing values from average
                const validWaterTemps = speciesData.filter(d => d.WaterTemp > 0);
                // Use 26Â°C as default if no water temp data (typical Bazaruto water temp)
                const avgWaterTemp = validWaterTemps.length > 0 ? _.meanBy(validWaterTemps, 'WaterTemp') : 26;
                const avgCloudCover = _.meanBy(speciesData, 'CloudCover');
                
                const weatherPreference = avgCloudCover < 30 ? 'Clear skies' : 
                                         avgCloudCover < 60 ? 'Partly cloudy' : 'Overcast';

                setRecommendations({
                    totalCatches: speciesData.length,
                    avgWeight: _.meanBy(speciesData, 'WeightLbs'),
                    maxWeight: _.maxBy(speciesData, 'WeightLbs')?.WeightLbs || 0,
                    topLocation: locationCounts[0],
                    allLocations: locationCounts.slice(0, 3),
                    topBait: baitCounts[0],
                    allBaits: baitCounts.slice(0, 3),
                    topEnhancement: enhancementCounts.length > 0 ? enhancementCounts[0] : null,
                    allEnhancements: enhancementCounts.slice(0, 3),
                    topMoon: moonCounts[0],
                    allMoons: moonCounts.slice(0, 3),
                    topTide: tideCounts[0],
                    allTides: tideCounts.slice(0, 3),
                    topTime: timeOfDay[0],
                    allTimes: timeOfDay,
                    avgWaterTemp: avgWaterTemp.toFixed(1),
                    weatherPreference
                });
            };

            const handleSpeciesChange = (newSpecies) => {
                setSelectedFish(newSpecies);
                analyzeSpecies(newSpecies, data);
            };
            
            const handleSaveCatch = async (catchData) => {
                try {
                    await saveCatchToDB(catchData);
                    await updatePendingCount();
                    showNotification('Catch saved! Will sync when online.', 'success');
                    setShowForm(false);
                    
                    // Try to sync immediately if online
                    if (isOnline) {
                        await syncPendingCatches();
                    }
                } catch (error) {
                    console.error('Error saving catch:', error);
                    showNotification('Failed to save catch: ' + error.message, 'error');
                }
            };
            
            // ============================================
            // Add Catch Form Component
            // ============================================
            const AddCatchForm = () => {
                const getCurrentDate = () => {
                    const now = new Date();
                    return now.toISOString().split('T')[0];
                };
                
                const getCurrentTime = () => {
                    const now = new Date();
                    return now.toTimeString().slice(0, 5);
                };
                
                const [formData, setFormData] = useState({
                    date: getCurrentDate(),
                    species: species[0] || '',
                    weightLbs: '',
                    length: '',
                    place: locations[0] || '',
                    primaryBait: baits[0] || '',
                    enhancement: '',
                    lineLbs: '',
                    timeOfStrike: getCurrentTime(),
                    waterTemp: '',
                    weather: 'Partly Cloudy',
                    tideState: 'Outgoing',
                    airTemp: '',
                    moon: 'Full'
                });
                
                const handleChange = (field, value) => {
                    setFormData(prev => ({ ...prev, [field]: value }));
                };
                
                const handleSubmit = (e) => {
                    e.preventDefault();
                    
                    // Validation
                    if (!formData.species || !formData.weightLbs || !formData.place || !formData.primaryBait) {
                        showNotification('Please fill in all required fields', 'error');
                        return;
                    }
                    
                    if (parseFloat(formData.weightLbs) <= 0) {
                        showNotification('Weight must be greater than 0', 'error');
                        return;
                    }
                    
                    handleSaveCatch(formData);
                };
                
                return React.createElement('div', {
                    className: 'modal-overlay',
                    onClick: (e) => {
                        if (e.target === e.currentTarget) setShowForm(false);
                    }
                }, React.createElement('div', {
                    className: 'bg-white rounded-t-3xl slide-in max-w-2xl mx-auto mt-auto p-6 max-h-[90vh] overflow-y-auto'
                }, [
                    // Header
                    React.createElement('div', {
                        key: 'header',
                        className: 'flex justify-between items-center mb-6'
                    }, [
                        React.createElement('h2', {
                            key: 'title',
                            className: 'text-2xl font-bold text-gray-800'
                        }, 'ðŸ“ Add New Catch'),
                        React.createElement('button', {
                            key: 'close',
                            onClick: () => setShowForm(false),
                            className: 'p-2 hover:bg-gray-100 rounded-full transition-all'
                        }, React.createElement(X, { className: 'h-6 w-6' }))
                    ]),
                    
                    // Form
                    React.createElement('form', {
                        key: 'form',
                        onSubmit: handleSubmit,
                        className: 'space-y-4'
                    }, [
                        // Date
                        React.createElement('div', { key: 'date' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold text-gray-700 mb-2'
                            }, 'Date *'),
                            React.createElement('input', {
                                key: 'input',
                                type: 'date',
                                value: formData.date,
                                onChange: (e) => handleChange('date', e.target.value),
                                required: true,
                                className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                            })
                        ]),
                        
                        // Species
                        React.createElement('div', { key: 'species' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold text-gray-700 mb-2'
                            }, 'Species *'),
                            React.createElement('select', {
                                key: 'input',
                                value: formData.species,
                                onChange: (e) => handleChange('species', e.target.value),
                                required: true,
                                className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                            }, species.map(sp => React.createElement('option', { key: sp, value: sp }, sp)))
                        ]),
                        
                        // Weight and Length (two columns)
                        React.createElement('div', {
                            key: 'weight-length',
                            className: 'grid grid-cols-2 gap-4'
                        }, [
                            React.createElement('div', { key: 'weight' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, 'Weight (lbs) *'),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'number',
                                    step: '0.1',
                                    value: formData.weightLbs,
                                    onChange: (e) => handleChange('weightLbs', e.target.value),
                                    required: true,
                                    placeholder: '25.5',
                                    className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                                })
                            ]),
                            React.createElement('div', { key: 'length' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, 'Length (m)'),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'number',
                                    step: '0.01',
                                    value: formData.length,
                                    onChange: (e) => handleChange('length', e.target.value),
                                    placeholder: '1.2',
                                    className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                                })
                            ])
                        ]),
                        
                        // Place
                        React.createElement('div', { key: 'place' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold text-gray-700 mb-2'
                            }, 'Place *'),
                            React.createElement('select', {
                                key: 'input',
                                value: formData.place,
                                onChange: (e) => handleChange('place', e.target.value),
                                required: true,
                                className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                            }, locations.map(loc => React.createElement('option', { key: loc, value: loc }, loc)))
                        ]),
                        
                        // Primary Bait
                        React.createElement('div', { key: 'bait' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold text-gray-700 mb-2'
                            }, 'Primary Bait *'),
                            React.createElement('select', {
                                key: 'input',
                                value: formData.primaryBait,
                                onChange: (e) => handleChange('primaryBait', e.target.value),
                                required: true,
                                className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                            }, baits.map(bait => React.createElement('option', { key: bait, value: bait }, bait)))
                        ]),
                        
                        // Enhancement
                        React.createElement('div', { key: 'enhancement' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold text-gray-700 mb-2'
                            }, 'Enhancement (optional)'),
                            React.createElement('select', {
                                key: 'input',
                                value: formData.enhancement,
                                onChange: (e) => handleChange('enhancement', e.target.value),
                                className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                            }, [
                                React.createElement('option', { key: 'none', value: '' }, 'None'),
                                ...enhancements.map(enh => React.createElement('option', { key: enh, value: enh }, enh))
                            ])
                        ]),
                        
                        // Line and Time
                        React.createElement('div', {
                            key: 'line-time',
                            className: 'grid grid-cols-2 gap-4'
                        }, [
                            React.createElement('div', { key: 'line' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, 'Line (lbs)'),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'number',
                                    step: '1',
                                    value: formData.lineLbs,
                                    onChange: (e) => handleChange('lineLbs', e.target.value),
                                    placeholder: '30',
                                    className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                                })
                            ]),
                            React.createElement('div', { key: 'time' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, 'Time of Strike'),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'time',
                                    value: formData.timeOfStrike,
                                    onChange: (e) => handleChange('timeOfStrike', e.target.value),
                                    className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                                })
                            ])
                        ]),
                        
                        // Water Temp and Air Temp
                        React.createElement('div', {
                            key: 'temps',
                            className: 'grid grid-cols-2 gap-4'
                        }, [
                            React.createElement('div', { key: 'water' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, 'Water Temp (Â°C)'),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'number',
                                    step: '0.1',
                                    value: formData.waterTemp,
                                    onChange: (e) => handleChange('waterTemp', e.target.value),
                                    placeholder: '26',
                                    className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                                })
                            ]),
                            React.createElement('div', { key: 'air' }, [
                                React.createElement('label', {
                                    key: 'label',
                                    className: 'block text-sm font-semibold text-gray-700 mb-2'
                                }, 'Air Temp (Â°C)'),
                                React.createElement('input', {
                                    key: 'input',
                                    type: 'number',
                                    step: '0.1',
                                    value: formData.airTemp,
                                    onChange: (e) => handleChange('airTemp', e.target.value),
                                    placeholder: '28',
                                    className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                                })
                            ])
                        ]),
                        
                        // Weather
                        React.createElement('div', { key: 'weather' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold text-gray-700 mb-2'
                            }, 'Weather'),
                            React.createElement('select', {
                                key: 'input',
                                value: formData.weather,
                                onChange: (e) => handleChange('weather', e.target.value),
                                className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                            }, [
                                React.createElement('option', { key: 'clear', value: 'Clear' }, 'Clear'),
                                React.createElement('option', { key: 'partly', value: 'Partly Cloudy' }, 'Partly Cloudy'),
                                React.createElement('option', { key: 'overcast', value: 'Overcast' }, 'Overcast'),
                                React.createElement('option', { key: 'rainy', value: 'Rainy' }, 'Rainy')
                            ])
                        ]),
                        
                        // Tide State
                        React.createElement('div', { key: 'tide' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold text-gray-700 mb-2'
                            }, 'Tide State'),
                            React.createElement('select', {
                                key: 'input',
                                value: formData.tideState,
                                onChange: (e) => handleChange('tideState', e.target.value),
                                className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                            }, [
                                React.createElement('option', { key: 'in', value: 'Incoming' }, 'Incoming'),
                                React.createElement('option', { key: 'out', value: 'Outgoing' }, 'Outgoing'),
                                React.createElement('option', { key: 'high', value: 'High' }, 'High'),
                                React.createElement('option', { key: 'low', value: 'Low' }, 'Low')
                            ])
                        ]),
                        
                        // Moon Phase
                        React.createElement('div', { key: 'moon' }, [
                            React.createElement('label', {
                                key: 'label',
                                className: 'block text-sm font-semibold text-gray-700 mb-2'
                            }, 'Moon Phase'),
                            React.createElement('select', {
                                key: 'input',
                                value: formData.moon,
                                onChange: (e) => handleChange('moon', e.target.value),
                                className: 'w-full p-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                            }, [
                                'New', 'Waxing Crescent', 'First Quarter', 'Waxing Gibbous',
                                'Full', 'Waning Gibbous', 'Last Quarter', 'Waning Crescent'
                            ].map(phase => React.createElement('option', { key: phase, value: phase }, phase)))
                        ]),
                        
                        // Submit Button
                        React.createElement('button', {
                            key: 'submit',
                            type: 'submit',
                            className: 'w-full bg-blue-600 text-white py-4 px-6 rounded-lg text-xl font-bold hover:bg-blue-700 transition-all flex items-center justify-center gap-2 mt-6'
                        }, [
                            React.createElement(Save, { key: 'icon', className: 'h-6 w-6' }),
                            React.createElement('span', { key: 'text' }, 'Save Catch')
                        ])
                    ])
                ]));
            };

            if (loading) {
                return React.createElement('div', {
                    className: "min-h-screen bg-gradient-to-b from-blue-400 to-blue-600 flex items-center justify-center p-4"
                }, React.createElement('div', {
                    className: "bg-white rounded-xl p-8 text-center shadow-2xl max-w-sm mx-auto"
                }, [
                    React.createElement('div', {
                        key: 'spinner',
                        className: "animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto mb-4"
                    }),
                    React.createElement('p', {
                        key: 'text',
                        className: "text-xl font-semibold sunlight-optimized"
                    }, "Loading fishing data..."),
                    React.createElement('p', {
                        key: 'subtext',
                        className: "text-gray-600 mt-2"
                    }, "Analyzing historical catches")
                ]));
            }

            if (error) {
                return React.createElement('div', {
                    className: "min-h-screen bg-gradient-to-b from-blue-400 to-blue-600 flex items-center justify-center p-4"
                }, React.createElement('div', {
                    className: "bg-white rounded-xl p-8 text-center shadow-2xl max-w-md mx-auto"
                }, [
                    React.createElement(AlertCircle, {
                        key: 'icon',
                        className: "h-16 w-16 text-red-500 mx-auto mb-4"
                    }),
                    React.createElement('p', {
                        key: 'title',
                        className: "text-xl font-semibold mb-2 sunlight-optimized"
                    }, "Data Loading Error"),
                    React.createElement('p', {
                        key: 'message',
                        className: "text-gray-600 mb-4"
                    }, error),
                    React.createElement('button', {
                        key: 'retry',
                        onClick: loadData,
                        className: "bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all"
                    }, "Try Again")
                ]));
            }

            if (!recommendations) {
                return React.createElement('div', {
                    className: "min-h-screen bg-gradient-to-b from-blue-400 to-blue-600 flex items-center justify-center p-4"
                }, React.createElement('div', {
                    className: "bg-white rounded-xl p-8 text-center shadow-2xl max-w-md mx-auto"
                }, [
                    React.createElement(AlertCircle, {
                        key: 'icon',
                        className: "h-16 w-16 text-orange-500 mx-auto mb-4"
                    }),
                    React.createElement('p', {
                        key: 'title',
                        className: "text-xl font-semibold sunlight-optimized"
                    }, "No data available"),
                    React.createElement('p', {
                        key: 'message',
                        className: "text-gray-600 mt-2"
                    }, "Please ensure the CSV file is uploaded and accessible.")
                ]));
            }

            return React.createElement('div', {
                className: "min-h-screen bg-gradient-to-b from-blue-400 to-blue-600 p-4 pb-24"
            }, [
                // Notification Toast
                notification && React.createElement('div', {
                    key: 'notification',
                    className: `fixed top-4 left-4 right-4 z-50 p-4 rounded-lg shadow-2xl ${
                        notification.type === 'success' ? 'bg-green-500' :
                        notification.type === 'error' ? 'bg-red-500' : 'bg-blue-500'
                    } text-white flex items-center gap-3`
                }, [
                    notification.type === 'success' && React.createElement(CheckCircle, { key: 'icon', className: 'h-6 w-6' }),
                    notification.type === 'error' && React.createElement(AlertCircle, { key: 'icon', className: 'h-6 w-6' }),
                    React.createElement('span', { key: 'message', className: 'flex-1 font-semibold' }, notification.message)
                ]),
                
                // Main Content
                React.createElement('div', {
                    key: 'content',
                    className: "max-w-2xl mx-auto"
                }, [
                    // Header with Status
                    React.createElement('div', {
                        key: 'header',
                        className: "bg-white rounded-xl shadow-2xl p-6 mb-4"
                    }, [
                        // Direct button link outside the main div for testing
                        React.createElement('a', {
                            key: 'direct-btn',
                            href: 'https://docs.google.com/forms/d/e/1FAIpQLSdvpVR2RHX20eDRkGjjlfyyZyBwaViGhszCn7sh0DVyfhim6g/viewform?usp=header',
                            target: '_blank',
                            rel: 'noopener noreferrer',
                            className: "block w-full bg-purple-600 text-white text-center font-bold py-3 mb-4 rounded-lg"
                        }, "DIRECT BUTTON - CLICK ME"),
                        
                        React.createElement('div', {
                            key: 'main',
                            className: "text-center"
                        }, [
                            React.createElement(Fish, {
                                key: 'icon',
                                className: "h-12 w-12 text-blue-600 mx-auto mb-3"
                            }),
                            React.createElement('h1', {
                                key: 'title',
                                className: "text-3xl font-bold text-gray-800 mb-2 sunlight-optimized"
                            }, "Boa Vida Fish Finder"),
                            React.createElement('p', {
                                key: 'subtitle',
                                className: "text-gray-600 mb-4"
                            }, `Based on historic catches`),
                            
                            // Log a Catch Button
                            React.createElement('a', {
                                key: 'log-catch-btn',
                                href: 'https://docs.google.com/forms/d/e/1FAIpQLSdvpVR2RHX20eDRkGjjlfyyZyBwaViGhszCn7sh0DVyfhim6g/viewform?usp=header',
                                target: '_blank',
                                rel: 'noopener noreferrer',
                                className: "inline-flex items-center justify-center gap-2 bg-red-600 hover:bg-red-700 text-white font-bold py-4 px-8 rounded-lg shadow-lg text-xl transition-colors mt-4"
                            }, [
                                React.createElement(Plus, { key: 'plus-icon', className: 'h-6 w-6' }),
                                "LOG A CATCH"
                            ])
                        ]),
                        
                        // Status Bar
                        React.createElement('div', {
                            key: 'status',
                            className: 'mt-4 pt-4 border-t border-gray-200 flex items-center justify-between text-sm'
                        }, [
                            // Online/Offline Status
                            React.createElement('div', {
                                key: 'online',
                                className: 'flex items-center gap-2'
                            }, [
                                React.createElement(isOnline ? Wifi : WifiOff, {
                                    key: 'icon',
                                    className: `h-5 w-5 ${isOnline ? 'text-green-600' : 'text-gray-400'}`
                                }),
                                React.createElement('span', {
                                    key: 'text',
                                    className: isOnline ? 'text-green-600 font-semibold' : 'text-gray-500'
                                }, isOnline ? 'Online' : 'Offline')
                            ]),
                            
                            // Pending Count
                            pendingCount > 0 && React.createElement('div', {
                                key: 'pending',
                                className: 'flex items-center gap-2 bg-orange-100 text-orange-700 px-3 py-1 rounded-full'
                            }, [
                                React.createElement('span', {
                                    key: 'dot',
                                    className: 'w-2 h-2 bg-orange-500 rounded-full pulse'
                                }),
                                React.createElement('span', {
                                    key: 'text',
                                    className: 'font-semibold'
                                }, `${pendingCount} pending`)
                            ]),
                            
                            // Sync Button
                            React.createElement('button', {
                                key: 'sync',
                                onClick: () => {
                                    if (pendingCount > 0) {
                                        syncPendingCatches();
                                    } else {
                                        loadData();
                                    }
                                },
                                disabled: syncing || (!isOnline && pendingCount === 0),
                                className: 'flex items-center gap-2 text-blue-600 font-semibold hover:text-blue-700 disabled:text-gray-400 disabled:cursor-not-allowed transition-all'
                            }, [
                                React.createElement(RefreshCw, {
                                    key: 'icon',
                                    className: `h-5 w-5 ${syncing ? 'animate-spin' : ''}`
                                }),
                                React.createElement('span', {
                                    key: 'text'
                                }, syncing ? 'Syncing...' : pendingCount > 0 ? 'Sync' : 'Refresh')
                            ]),
                            
                            // Last Sync Time
                            lastSync && React.createElement('div', {
                                key: 'lastSync',
                                className: 'text-xs text-gray-500'
                            }, `Synced: ${lastSync.toLocaleTimeString()}`)
                        ])
                    ]),

                // Fish Selector
                React.createElement('div', {
                    key: 'selector',
                    className: "bg-white rounded-xl shadow-2xl p-6 mb-4"
                }, [
                    React.createElement('label', {
                        key: 'label',
                        className: "block text-lg font-semibold text-gray-700 mb-3 sunlight-optimized"
                    }, "What fish do you want to catch?"),
                    React.createElement('select', {
                        key: 'select',
                        value: selectedFish,
                        onChange: (e) => handleSpeciesChange(e.target.value),
                        className: "w-full text-2xl font-bold p-4 border-2 border-blue-300 rounded-lg focus:ring-4 focus:ring-blue-500 focus:border-blue-500 sunlight-optimized"
                    }, species.map(sp => React.createElement('option', {
                        key: sp,
                        value: sp
                    }, sp))),
                    
                    React.createElement('div', {
                        key: 'stats',
                        className: "mt-4 p-4 bg-blue-50 rounded-lg"
                    }, [
                        React.createElement('div', {
                            key: 'total',
                            className: "flex justify-between items-center"
                        }, [
                            React.createElement('span', {
                                key: 'label',
                                className: "text-gray-700"
                            }, "Total caught:"),
                            React.createElement('span', {
                                key: 'value',
                                className: "text-2xl font-bold text-blue-600 sunlight-optimized"
                            }, recommendations.totalCatches)
                        ]),
                        React.createElement('div', {
                            key: 'avg',
                            className: "flex justify-between items-center mt-2"
                        }, [
                            React.createElement('span', {
                                key: 'label',
                                className: "text-gray-700"
                            }, "Average weight:"),
                            React.createElement('span', {
                                key: 'value',
                                className: "text-xl font-bold text-blue-600 sunlight-optimized"
                            }, `${recommendations.avgWeight.toFixed(1)} lbs`)
                        ]),
                        React.createElement('div', {
                            key: 'max',
                            className: "flex justify-between items-center mt-2"
                        }, [
                            React.createElement('span', {
                                key: 'label',
                                className: "text-gray-700"
                            }, "Biggest catch:"),
                            React.createElement('span', {
                                key: 'value',
                                className: "text-xl font-bold text-blue-600 sunlight-optimized"
                            }, `${recommendations.maxWeight.toFixed(1)} lbs`)
                        ])
                    ])
                ]),

                // Best Location
                React.createElement('div', {
                    key: 'location',
                    className: "bg-white rounded-xl shadow-2xl p-6 mb-4"
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: "flex items-center mb-4"
                    }, [
                        React.createElement(MapPin, {
                            key: 'icon',
                            className: "h-8 w-8 text-green-600 mr-3"
                        }),
                        React.createElement('h2', {
                            key: 'title',
                            className: "text-2xl font-bold text-gray-800 sunlight-optimized"
                        }, "Where to Fish")
                    ]),
                    
                    React.createElement('div', {
                        key: 'best',
                        className: "bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-6 mb-4"
                    }, React.createElement('div', {
                        className: "text-center"
                    }, [
                        React.createElement('div', {
                            key: 'label',
                            className: "text-lg text-green-700 mb-2"
                        }, "ðŸŽ¯ BEST SPOT"),
                        React.createElement('div', {
                            key: 'name',
                            className: "text-3xl font-bold text-green-900 mb-2 sunlight-optimized"
                        }, recommendations.topLocation[0]),
                        React.createElement('div', {
                            key: 'stats',
                            className: "text-xl text-green-700"
                        }, `${recommendations.topLocation[1].count} catches (${recommendations.topLocation[1].percentage.toFixed(0)}% success)`),
                        React.createElement('div', {
                            key: 'avg',
                            className: "text-lg text-green-600 mt-2"
                        }, `Avg: ${recommendations.topLocation[1].avgWeight.toFixed(1)} lbs`)
                    ])),

                    recommendations.allLocations.length > 1 && React.createElement('div', {
                        key: 'others',
                        className: "space-y-2"
                    }, [
                        React.createElement('div', {
                            key: 'label',
                            className: "text-sm font-semibold text-gray-600 mb-2"
                        }, "Other good spots:"),
                        ...recommendations.allLocations.slice(1).map(([place, data], index) => 
                            React.createElement('div', {
                                key: index,
                                className: "flex justify-between items-center bg-gray-50 p-3 rounded-lg"
                            }, [
                                React.createElement('span', {
                                    key: 'name',
                                    className: "font-medium text-gray-800"
                                }, place),
                                React.createElement('span', {
                                    key: 'count',
                                    className: "text-gray-600"
                                }, `${data.count} catches`)
                            ])
                        )
                    ])
                ]),

                // Best Bait
                React.createElement('div', {
                    key: 'bait',
                    className: "bg-white rounded-xl shadow-2xl p-6 mb-4"
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: "flex items-center mb-4"
                    }, [
                        React.createElement(Fish, {
                            key: 'icon',
                            className: "h-8 w-8 text-orange-600 mr-3"
                        }),
                        React.createElement('h2', {
                            key: 'title',
                            className: "text-2xl font-bold text-gray-800 sunlight-optimized"
                        }, "What Bait to Use")
                    ]),
                    
                    React.createElement('div', {
                        key: 'best',
                        className: "bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-6 mb-4"
                    }, React.createElement('div', {
                        className: "text-center"
                    }, [
                        React.createElement('div', {
                            key: 'label',
                            className: "text-lg text-orange-700 mb-2"
                        }, "ðŸŽ£ BEST BAIT"),
                        React.createElement('div', {
                            key: 'name',
                            className: "text-3xl font-bold text-orange-900 mb-2 sunlight-optimized"
                        }, recommendations.topBait[0]),
                        React.createElement('div', {
                            key: 'stats',
                            className: "text-xl text-orange-700"
                        }, `${recommendations.topBait[1].count} catches (${recommendations.topBait[1].percentage.toFixed(0)}% success)`),
                        React.createElement('div', {
                            key: 'avg',
                            className: "text-lg text-orange-600 mt-2"
                        }, `Avg: ${recommendations.topBait[1].avgWeight.toFixed(1)} lbs`)
                    ])),

                    recommendations.allBaits.length > 1 && React.createElement('div', {
                        key: 'others',
                        className: "space-y-2"
                    }, [
                        React.createElement('div', {
                            key: 'label',
                            className: "text-sm font-semibold text-gray-600 mb-2"
                        }, "Other good baits:"),
                        ...recommendations.allBaits.slice(1).map(([bait, data], index) => 
                            React.createElement('div', {
                                key: index,
                                className: "flex justify-between items-center bg-gray-50 p-3 rounded-lg"
                            }, [
                                React.createElement('span', {
                                    key: 'name',
                                    className: "font-medium text-gray-800"
                                }, bait),
                                React.createElement('span', {
                                    key: 'count',
                                    className: "text-gray-600"
                                }, `${data.count} catches`)
                            ])
                        )
                    ])
                ]),

                // Best Enhancement (conditional)
                recommendations.topEnhancement && React.createElement('div', {
                    key: 'enhancement',
                    className: "bg-white rounded-xl shadow-2xl p-6 mb-4"
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: "flex items-center mb-4"
                    }, [
                        React.createElement(TrendingUp, {
                            key: 'icon',
                            className: "h-8 w-8 text-pink-600 mr-3"
                        }),
                        React.createElement('h2', {
                            key: 'title',
                            className: "text-2xl font-bold text-gray-800 sunlight-optimized"
                        }, "Bait Enhancement")
                    ]),
                    
                    React.createElement('div', {
                        key: 'best',
                        className: "bg-gradient-to-r from-pink-50 to-pink-100 rounded-lg p-6 mb-4"
                    }, React.createElement('div', {
                        className: "text-center"
                    }, [
                        React.createElement('div', {
                            key: 'label',
                            className: "text-lg text-pink-700 mb-2"
                        }, "âœ¨ BEST ENHANCEMENT"),
                        React.createElement('div', {
                            key: 'name',
                            className: "text-3xl font-bold text-pink-900 mb-2 sunlight-optimized"
                        }, recommendations.topEnhancement[0]),
                        React.createElement('div', {
                            key: 'stats',
                            className: "text-xl text-pink-700"
                        }, `${recommendations.topEnhancement[1].count} catches (${recommendations.topEnhancement[1].percentage.toFixed(0)}% when used)`),
                        React.createElement('div', {
                            key: 'avg',
                            className: "text-lg text-pink-600 mt-2"
                        }, `Avg: ${recommendations.topEnhancement[1].avgWeight.toFixed(1)} lbs`),
                        recommendations.topEnhancement[1].usedWith && React.createElement('div', {
                            key: 'used-with',
                            className: "text-sm text-pink-600 mt-2"
                        }, `Often used with: ${recommendations.topEnhancement[1].usedWith[0]}`)
                    ])),

                    recommendations.allEnhancements.length > 1 && React.createElement('div', {
                        key: 'others',
                        className: "space-y-2"
                    }, [
                        React.createElement('div', {
                            key: 'label',
                            className: "text-sm font-semibold text-gray-600 mb-2"
                        }, "Other enhancements:"),
                        ...recommendations.allEnhancements.slice(1).map(([enhancement, data], index) => 
                            React.createElement('div', {
                                key: index,
                                className: "flex justify-between items-center bg-gray-50 p-3 rounded-lg"
                            }, [
                                React.createElement('span', {
                                    key: 'name',
                                    className: "font-medium text-gray-800"
                                }, enhancement),
                                React.createElement('span', {
                                    key: 'count',
                                    className: "text-gray-600"
                                }, `${data.count} catches`)
                            ])
                        )
                    ])
                ]),

                // Best Time
                React.createElement('div', {
                    key: 'time',
                    className: "bg-white rounded-xl shadow-2xl p-6 mb-4"
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: "flex items-center mb-4"
                    }, [
                        React.createElement(Clock, {
                            key: 'icon',
                            className: "h-8 w-8 text-purple-600 mr-3"
                        }),
                        React.createElement('h2', {
                            key: 'title',
                            className: "text-2xl font-bold text-gray-800 sunlight-optimized"
                        }, "When to Fish")
                    ]),
                    
                    React.createElement('div', {
                        key: 'best',
                        className: "bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-6 mb-4"
                    }, React.createElement('div', {
                        className: "text-center"
                    }, [
                        React.createElement('div', {
                            key: 'label',
                            className: "text-lg text-purple-700 mb-2"
                        }, "â° BEST TIME"),
                        React.createElement('div', {
                            key: 'name',
                            className: "text-3xl font-bold text-purple-900 mb-2 sunlight-optimized"
                        }, recommendations.topTime[0]),
                        React.createElement('div', {
                            key: 'stats',
                            className: "text-xl text-purple-700"
                        }, `${recommendations.topTime[1].count} catches (${recommendations.topTime[1].percentage.toFixed(0)}% success)`)
                    ])),

                    recommendations.allTimes.length > 1 && React.createElement('div', {
                        key: 'others',
                        className: "space-y-2"
                    }, recommendations.allTimes.slice(1).map(([time, data], index) => 
                        React.createElement('div', {
                            key: index,
                            className: "flex justify-between items-center bg-gray-50 p-3 rounded-lg"
                        }, [
                            React.createElement('span', {
                                key: 'name',
                                className: "font-medium text-gray-800"
                            }, time),
                            React.createElement('span', {
                                key: 'count',
                                className: "text-gray-600"
                            }, `${data.count} catches`)
                        ])
                    ))
                ]),

                // Best Conditions
                React.createElement('div', {
                    key: 'conditions',
                    className: "bg-white rounded-xl shadow-2xl p-6 mb-4"
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: "flex items-center mb-4"
                    }, [
                        React.createElement(Sun, {
                            key: 'icon',
                            className: "h-8 w-8 text-yellow-600 mr-3"
                        }),
                        React.createElement('h2', {
                            key: 'title',
                            className: "text-2xl font-bold text-gray-800 sunlight-optimized"
                        }, "Best Conditions")
                    ]),
                    
                    React.createElement('div', {
                        key: 'conditions-list',
                        className: "space-y-3"
                    }, [
                        // Moon Phase
                        React.createElement('div', {
                            key: 'moon',
                            className: "bg-indigo-50 rounded-lg p-4"
                        }, React.createElement('div', {
                            className: "flex items-center justify-between"
                        }, [
                            React.createElement('div', {
                                key: 'left',
                                className: "flex items-center"
                            }, [
                                React.createElement(Moon, {
                                    key: 'icon',
                                    className: "h-6 w-6 text-indigo-600 mr-3"
                                }),
                                React.createElement('div', {
                                    key: 'content'
                                }, [
                                    React.createElement('div', {
                                        key: 'label',
                                        className: "font-semibold text-gray-800"
                                    }, "Moon Phase"),
                                    React.createElement('div', {
                                        key: 'value',
                                        className: "text-2xl font-bold text-indigo-900 sunlight-optimized"
                                    }, recommendations.topMoon[0])
                                ])
                            ]),
                            React.createElement('div', {
                                key: 'right',
                                className: "text-right"
                            }, [
                                React.createElement('div', {
                                    key: 'label',
                                    className: "text-sm text-gray-600"
                                }, "Success rate"),
                                React.createElement('div', {
                                    key: 'value',
                                    className: "text-xl font-bold text-indigo-600 sunlight-optimized"
                                }, `${recommendations.topMoon[1].percentage.toFixed(0)}%`)
                            ])
                        ])),

                        // Tide State
                        React.createElement('div', {
                            key: 'tide',
                            className: "bg-cyan-50 rounded-lg p-4"
                        }, React.createElement('div', {
                            className: "flex items-center justify-between"
                        }, [
                            React.createElement('div', {
                                key: 'left',
                                className: "flex items-center"
                            }, [
                                React.createElement(Droplets, {
                                    key: 'icon',
                                    className: "h-6 w-6 text-cyan-600 mr-3"
                                }),
                                React.createElement('div', {
                                    key: 'content'
                                }, [
                                    React.createElement('div', {
                                        key: 'label',
                                        className: "font-semibold text-gray-800"
                                    }, "Tide"),
                                    React.createElement('div', {
                                        key: 'value',
                                        className: "text-2xl font-bold text-cyan-900 sunlight-optimized"
                                    }, recommendations.topTide[0])
                                ])
                            ]),
                            React.createElement('div', {
                                key: 'right',
                                className: "text-right"
                            }, [
                                React.createElement('div', {
                                    key: 'label',
                                    className: "text-sm text-gray-600"
                                }, "Success rate"),
                                React.createElement('div', {
                                    key: 'value',
                                    className: "text-xl font-bold text-cyan-600 sunlight-optimized"
                                }, `${recommendations.topTide[1].percentage.toFixed(0)}%`)
                            ])
                        ])),

                        // Weather
                        React.createElement('div', {
                            key: 'weather',
                            className: "bg-sky-50 rounded-lg p-4"
                        }, React.createElement('div', {
                            className: "flex items-center justify-between"
                        }, [
                            React.createElement('div', {
                                key: 'left',
                                className: "flex items-center"
                            }, [
                                React.createElement(Sun, {
                                    key: 'icon',
                                    className: "h-6 w-6 text-sky-600 mr-3"
                                }),
                                React.createElement('div', {
                                    key: 'content'
                                }, [
                                    React.createElement('div', {
                                        key: 'label',
                                        className: "font-semibold text-gray-800"
                                    }, "Weather"),
                                    React.createElement('div', {
                                        key: 'value',
                                        className: "text-2xl font-bold text-sky-900 sunlight-optimized"
                                    }, recommendations.weatherPreference)
                                ])
                            ]),
                            React.createElement('div', {
                                key: 'right',
                                className: "text-right"
                            }, [
                                React.createElement('div', {
                                    key: 'label',
                                    className: "text-sm text-gray-600"
                                }, "Water temp"),
                                React.createElement('div', {
                                    key: 'value',
                                    className: "text-xl font-bold text-sky-600 sunlight-optimized"
                                }, `${recommendations.avgWaterTemp}Â°C`)
                            ])
                        ]))
                    ])
                ]),

                // Quick Summary
                React.createElement('div', {
                    key: 'summary',
                    className: "bg-gradient-to-r from-green-500 to-blue-500 rounded-xl shadow-2xl p-6 text-white"
                }, [
                    React.createElement('div', {
                        key: 'header',
                        className: "flex items-center mb-4"
                    }, [
                        React.createElement(TrendingUp, {
                            key: 'icon',
                            className: "h-8 w-8 mr-3"
                        }),
                        React.createElement('h2', {
                            key: 'title',
                            className: "text-2xl font-bold sunlight-optimized"
                        }, "Quick Summary")
                    ]),
                    React.createElement('div', {
                        key: 'content',
                        className: "text-lg leading-relaxed"
                    }, [
                        React.createElement('p', {
                            key: 'intro',
                            className: "mb-3 sunlight-optimized"
                        }, React.createElement('strong', null, `To catch ${selectedFish}:`)),
                        React.createElement('p', {
                            key: 'location',
                            className: "mb-2"
                        }, [
                            "ðŸŽ¯ Fish at ",
                            React.createElement('strong', { key: 'strong' }, recommendations.topLocation[0])
                        ]),
                        React.createElement('p', {
                            key: 'bait',
                            className: "mb-2"
                        }, [
                            "ðŸŽ£ Use ",
                            React.createElement('strong', { key: 'strong' }, recommendations.topBait[0]),
                            " as bait"
                        ]),
                        recommendations.topEnhancement && React.createElement('p', {
                            key: 'enhancement',
                            className: "mb-2"
                        }, [
                            "âœ¨ Add ",
                            React.createElement('strong', { key: 'strong' }, recommendations.topEnhancement[0]),
                            " enhancement"
                        ]),
                        React.createElement('p', {
                            key: 'time',
                            className: "mb-2"
                        }, [
                            "â° Go fishing ",
                            React.createElement('strong', { key: 'strong' }, recommendations.topTime[0].toLowerCase())
                        ]),
                        React.createElement('p', {
                            key: 'moon',
                            className: "mb-2"
                        }, [
                            "ðŸŒ™ Best during ",
                            React.createElement('strong', { key: 'strong' }, recommendations.topMoon[0])
                        ]),
                        React.createElement('p', {
                            key: 'tide'
                        }, [
                            "ðŸŒŠ Target ",
                            React.createElement('strong', { key: 'strong' }, recommendations.topTide[0].toLowerCase()),
                            " tide"
                        ])
                    ])
                ]),

                // Footer
                React.createElement('div', {
                    key: 'footer',
                    className: "text-center mt-6 text-white text-sm"
                }, [
                    React.createElement('p', {
                        key: 'line1'
                    }, "Based on historical catch data from Bazaruto"),
                    React.createElement('p', {
                        key: 'line2',
                        className: "mt-1"
                    }, "Good luck fishing! ðŸŽ£")
                ])
            ]),
            
            // Floating Action Button (Log a Catch with Google Form)
            React.createElement('a', {
                key: 'fab',
                href: 'https://docs.google.com/forms/d/e/1FAIpQLSdvpVR2RHX20eDRkGjjlfyyZyBwaViGhszCn7sh0DVyfhim6g/viewform?usp=header',
                target: '_blank',
                rel: 'noopener noreferrer',
                className: 'fab bg-red-600 hover:bg-red-700 text-white p-6 rounded-full transition-all hover:scale-110 active:scale-95 flex items-center justify-center shadow-xl'
            }, [
                React.createElement(Plus, { className: 'h-10 w-10' }),
                React.createElement('span', { 
                    className: 'ml-2 font-bold text-lg',
                    style: { display: 'inline-block' }
                }, 'LOG')
            ]),
            
            // Add Catch Form Modal
            showForm && React.createElement(AddCatchForm, { key: 'form' })
            ]);
        };

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        console.log("Rendering SimpleFishingGuide component...");
        root.render(React.createElement(SimpleFishingGuide));
        console.log("Component rendered!");
    </script>
</body>
</html>
